############################################################################
# Installed targets

LIB     = libwin.a

############################################################################
# List object files that comprise BIN.

OBJS =  del_win.o \
	init_double.o \
	init_enum.o \
	init_int.o \
	init_ldouble.o \
	init_llong.o \
	init_long.o \
	init_menu.o \
	init_string.o \
	new_win.o \
	panel_check.o \
	print_cur.o \
	sub_win.o \
	waddstr.o \
	wblank.o \
	wbut_resp.o \
	wclear.o \
	wclear_eol.o \
	wclear_eow.o \
	wdelete_ch.o \
	wdelete_line.o \
	wdump.o \
	wget_item.o \
	wget_path.o \
	wget_resp.o \
	wgetc.o \
	wgetenum.o \
	wgetevent.o \
	wgetfloat.o \
	wgetint.o \
	wgetmenu.o \
	wgetseq.o \
	wgetstring.o \
	whigh_print.o \
	whl_menu.o \
	whome.o \
	winn_border.o \
	winput_pan.o \
	winsert_ch.o \
	winsert_line.o \
	wlist_win.o \
	wmenu.o \
	wmouseinwin.o \
	wmove_down.o \
	wmove_left.o \
	wmove_right.o \
	wmove_to.o \
	wmove_up.o \
	wmsg_win.o \
	wout_border.o \
	wprint_cen.o \
	wprintat.o \
	wprintf.o \
	wputc.o \
	wputs.o \
	wredraw.o \
	wredraw_all.o \
	wredraw_line.o \
	wresp_win.o \
	wrestore.o \
	wrestore_lin.o \
	wscroll_bar.o \
	wscroll_for.o \
	wscroll_rev.o \
	wset_bg.o \
	wset_fg.o \
	wset_wattr.o \
	wshadow.o \
	wsync_modes.o \
	wunlist_win.o

############################################################################
# Compile, link, and install options

# Install in /usr/local, unless defined by the parent Makefile, the
# environment, or a command line option such as PREFIX=/opt/local.
PREFIX      ?= /usr/local
MANPREFIX   ?= ${PREFIX}

# Where to find local libraries and headers.  For MacPorts, override
# with "make LOCALBASE=/opt/local"
LOCALBASE   ?= ${PREFIX}

############################################################################
# Build flags
# Override with "make CC=gcc", "make CC=icc", etc.
# Do not add non-portable options (such as -Wall) using +=

# Portable defaults.  Can be overridden by mk.conf or command line.
CC          ?= gcc
CFLAGS      ?= -Wall -g

CPP         ?= cpp

AR          ?= ar
RANLIB      ?= ranlib

INCLUDES    += -I. -I../Terminal -I../Image -I../Mouse -I${LOCALBASE}/include
CFLAGS      += ${INCLUDES}

############################################################################
# Assume first command in PATH.  Override with full pathnames if necessary.
# E.g. "make INSTALL=/usr/local/bin/ginstall"
# Do not place flags here (e.g. RM = rm -f).  Just provide the command
# and let each usage dictate the flags.

MKDIR   ?= mkdir
INSTALL ?= install
LN      ?= ln
RM      ?= rm
PRINTF  ?= printf

############################################################################
# Archive rules

all:    ${LIB}

${LIB}: ${OBJS}
	${AR} r ${LIB} ${OBJS}
	${RANLIB} ${LIB}

############################################################################
# Include dependencies generated by "make depend", if they exist.
# These rules explicitly list dependencies for each object file.
# See "depend" target below.  If Makefile.depend does not exist, use
# generic source compile rules.  These have some limitations, so you
# may prefer to create explicit rules for each target file.  This can
# be done automatically using "cpp -M" or "cpp -MM".  Run "man cpp"
# for more information, or see the "depend" target below.

# Rules generated by "make depend"
include Makefile.depend

############################################################################
# Self-generate dependencies the old-fashioned way

depend:
	rm -f Makefile.depend
	for file in *.c; do \
	    ${CPP} ${INCLUDES} -MM $${file} >> Makefile.depend; \
	    ${PRINTF} "\t\$${CC} -c \$${CFLAGS} $${file}\n\n" >> Makefile.depend; \
	done

############################################################################
# Remove generated files (objs and nroff output from man pages)

clean:
	rm -f ${OBJS} ${LIB} *.nr

# Keep backup files during normal clean, but provide an option to remove them
realclean: clean
	rm -f .*.bak *.bak *.BAK *.gmon core *.core

